package de.rwth.armin.modeling.autopilot.behavior;

component BehaviorGeneration {
  port
    in  Q (-oo m : 0.01 m : oo m)                    currentPositionX,
    in  Q (-oo m : 0.01 m : oo m)                    currentPositionY,

    in  Q (-oo m : 0.01 m : oo m)                    current_direction_x,
    in  Q (-oo m : 0.01 m : oo m)                    current_direction_y,

    in  Z (0 : 100)                                  plannedTrajectoryLength,
    in  Q (-oo m : 0.01 m : oo m) ^ {1,100}          plannedTrajectoryX,
    in  Q (-oo m : 0.01 m : oo m) ^ {1,100}          plannedTrajectoryY,

    out Q (-oo m : 0.01 m : oo m)                    desired_direction_x,
    out Q (-oo m : 0.01 m : oo m)                    desired_direction_y,
    out Q (-oo m : 0.01 m : oo m)                    signedDistanceToTrajectory,
    out Q (0.0 m/s : 0.01 m/s : 13.0 m/s)            desiredVelocity;

  instance TrimPath tp;
  instance CalculateMotionCommands cmc;

  connect currentPositionX                  ->       tp.currentPositionX;
  connect currentPositionY                  ->       tp.currentPositionY;
  connect plannedTrajectoryLength           ->       tp.plannedTrajectoryLength;
  connect plannedTrajectoryX                ->       tp.plannedTrajectoryX;
  connect plannedTrajectoryY                ->       tp.plannedTrajectoryY;

  connect currentPositionX                  ->       cmc.currentPositionX;
  connect currentPositionY                  ->       cmc.currentPositionY;
  connect current_direction_x               ->       cmc.current_direction_x;
  connect current_direction_y               ->       cmc.current_direction_y;
  connect tp.trimmedTrajectoryLength        ->       cmc.trimmedTrajectoryLength;
  connect tp.trimmedTrajectoryX             ->       cmc.trimmedTrajectoryX;
  connect tp.trimmedTrajectoryY             ->       cmc.trimmedTrajectoryY;

  connect cmc.desired_direction_x           ->       desired_direction_x;
  connect cmc.desired_direction_y           ->       desired_direction_y;
  connect cmc.signedDistanceToTrajectory    ->       signedDistanceToTrajectory;
  connect cmc.desiredVelocity               ->       desiredVelocity;
}
